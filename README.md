# D-Link Exploit
The exploit exists in the devices server, alphapd, when processing `wireless.htm` 
prior to displaying it to the user. If `WepEncryption` is provided in the 
URL this leads to a buffer overflow if the value is longer than 0x28 bytes. A 
URL of the form:
 
     http://IP_ADDRESS/wireless.htm?WEPEncryption=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB

will exercise the exploit and begin executing at `0x42424242`. 

**Note: The exploit requires credentials to be successful.**
**Default credentials are admin with a blank password.**

## dcs5020l_arbitrary_code.py
Full exploit that takes advantage of a buffer overflow in the alphapd server to 
execute an arbitrary command on the device. It has been tested on the DCS-5020L
with the most recent version of the firmware, 1.15.12. The ROP chain will likely
need to be adjusted for older versions of the firmware as well as for different 
devices.

## dcs_crash.py
POC code for simply crashing the device. It sends the URL mentioned above causing
the server to crash as it beings executing at address `0x42424242`. 

## Vulnerable Devices
Below is the list of devices effected by this exploit. All versions of the firmware
are currently vulnerable. 

**DCS-930L**

**DCS-931L**

**DCS-932L**

**DCS-933L**

**DCS-934L**

**DCS-5009L**

**DCS-5010L**

**DCS-5020L**

**DCS-5025L**

**DCS-5030L**


## Live Vulnerable Devices
https://www.shodan.io/search?query=Server%3A+alphapd

## Example Usage
`python dcs5020l_arbitrary_code.py -i 192.168.0.100 -P 80 -u admin -p "" -d`